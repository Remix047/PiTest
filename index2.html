<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pi Network App</title>
    <script src="https://sdk.minepi.com/pi-sdk.js"></script>
    <script>
        // Inicializar el SDK de Pi Network
        Pi.init({ version: "2.0" sandbox: true });

        // Función para manejar pagos incompletos (opcional)
        function onIncompletePaymentFound(payment) {
            console.log("Pago incompleto encontrado:", payment);
        }

        // Función para autenticar al usuario y solicitar un pago
        function authenticateAndPay() {
            const scopes = ['payments'];

            Pi.authenticate(scopes, onIncompletePaymentFound).then(function(auth) {
                console.log("Usuario autenticado:", auth);

                // Solicitar un pago de 1 Pi
                Pi.createPayment({
                    amount: 1,
                    memo: "Pago de 1 Pi por servicios",
                    metadata: { transactionId: "12345" }
                }, {
                    onReadyForServerApproval: function(paymentId) {
                        console.log("Pago listo para aprobación del servidor:", paymentId);
                        // Aquí deberías enviar el paymentId a tu servidor para su aprobación
                    },
                    onReadyForServerCompletion: function(paymentId, txid) {
                        console.log("Pago listo para completación del servidor:", paymentId, txid);
                        // Aquí deberías enviar el paymentId y txid a tu servidor para su completación
                    },
                    onCancel: function(paymentId) {
                        console.log("Pago cancelado por el usuario:", paymentId);
                    },
                    onError: function(error, payment) {
                        console.error("Error en el pago:", error, payment);
                    }
                });
            }).catch(function(error) {
                console.error("Error en la autenticación:", error);
            });
        }
    </script>
</head>
<body>
    <h1>Pi Network App</h1>
    <button onclick="authenticateAndPay()">Autenticar y Pagar 1 Pi</button>
</body>
</html>
